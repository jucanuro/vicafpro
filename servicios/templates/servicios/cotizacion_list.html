{% extends 'base_vicafpro.html' %}
{% load static %}
{% load humanize %}

{% block title %}Listado de Cotizaciones{% endblock %}

{% block content %}
<div class="p-6 lg:p-10 max-w-7xl mx-auto animate-fade-in-up">
    <header class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6">
        <div class="mb-4 md:mb-0">
            <h1 class="text-xl font-extrabold text-white">Listado de Cotizaciones</h1>
            <p class="text-slate-400 mt-1">Revisa, edita o elimina cotizaciones existentes.</p>
        </div>
        <div class="w-full md:w-auto">
            <a href="{% url 'servicios:crear_cotizacion' %}" class="w-full md:w-auto btn-primary-lg flex hover:bg-emerald-600 hover:rounded-lg p-2">
                <i data-lucide="plus" class="w-5 h-5 mr-2"></i>
                Crear Nueva Cotizaci√≥n
            </a>
        </div>
    </header>

    <div class="card p-6 bg-slate-800/50 rounded-2xl shadow-2xl overflow-x-auto">
        {% if cotizaciones %}
        <table class="min-w-full divide-y divide-slate-700">
            <thead>
                <tr>
                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider">
                        Nro. Oferta
                    </th>
                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider">
                        Cliente
                    </th>
                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider">
                        Fecha
                    </th>
                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider">
                        Estado
                    </th>
                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider">
                        Monto Total
                    </th>
                    <th scope="col" class="relative px-6 py-3">
                        <span class="sr-only">Acciones</span>
                    </th>
                </tr>
            </thead>
            <tbody class="divide-y divide-slate-700">
                {% for cotizacion in cotizaciones %}
                <tr class="hover:bg-slate-700/50 transition-colors duration-200">
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-white">
                        {{ cotizacion.numero_oferta }}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-slate-300">
                        {{ cotizacion.razon_social }}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-slate-300">
                        {{ cotizacion.fecha_emision|date:"d M Y" }}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm">
                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full
                            {% if cotizacion.estado == 'ENVIADA' %}bg-blue-100 text-blue-800{% endif %}
                            {% if cotizacion.estado == 'APROBADA' %}bg-emerald-100 text-emerald-800{% endif %}
                            {% if cotizacion.estado == 'RECHAZADA' %}bg-rose-100 text-rose-800{% endif %}">
                            {{ cotizacion.get_estado_display }}
                        </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-white">
                        S/ {{ cotizacion.monto_total|intcomma }}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                        <div class="flex justify-end space-x-2">
                            <a href=""
                                class="text-emerald-500 hover:text-emerald-400"
                                title="Editar">
                                <i data-lucide="edit" class="w-5 h-5"></i>
                            </a>
                            <a href=""
                                class="text-rose-500 hover:text-rose-400"
                                title="Eliminar">
                                <i data-lucide="trash-2" class="w-5 h-5"></i>
                            </a>
                            <a href=""
                                class="text-blue-500 hover:text-blue-400"
                                title="Ver detalles">
                                <i data-lucide="eye" class="w-5 h-5"></i>
                            </a>
                        </div>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% else %}
        <div class="text-center py-10">
            <i data-lucide="file-x" class="w-16 h-16 text-slate-500 mx-auto mb-4"></i>
            <p class="text-slate-400 font-medium">No se encontraron cotizaciones.</p>
        </div>
        {% endif %}
    </div>
</div>

<style>
    .btn-primary-lg {
        @apply inline-flex items-center px-6 py-3 border border-transparent text-base font-semibold rounded-full shadow-sm text-white bg-emerald-600 hover:bg-emerald-700 transition-colors duration-300 transform hover:scale-105;
    }
</style>
{% endblock %}